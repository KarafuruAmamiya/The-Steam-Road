persian_renaissance_science_philosophy = { #include secular philosophy
	name = "persian_renaissance_science_philosophy_button"
	desc = "persian_renaissance_science_philosophy_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			has_variable = persian_renaissance_science_philosophy
		}
		ig:ig_intelligentsia = {
			is_marginalized = no
		}
		has_technology_researched = realism
		any_scope_building = {
			count >= 5
			is_building_type = building_university
			OR = {
				has_active_production_method = pm_philosophy_department
				has_active_production_method = pm_analytical_philosophy_department
			}
			occupancy >= 0.9
			level >= 3
		}
		institution_investment_level = {
			institution = institution_schools
			value >= 5
		}
	}

	effect = {
		set_variable = persian_renaissance_science_philosophy
		trigger_event = { id = persian_renaissance.9 }
		change_variable = {
			name = persian_renaissance_var
			add = 1
		}
	}
}

persian_renaissance_historical_sites = {
	name = "persian_renaissance_historical_sites_button"
	desc = "persian_renaissance_historical_sites_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			has_variable = persian_renaissance_historical_sites
		}
		any_scope_building = {
			count >= 5
			is_building_type = building_argebam
			is_building_type = building_persepolis
			is_building_type = building_susa
			is_building_type = building_gonbad_e_qabus
			is_building_type = building_yazd_atash_beram
			is_building_type = building_ctesiphon
			is_building_type = building_soltaniyeh
		}
	}

	effect = {
		trigger_event = { id = persian_renaissance.2 }
		set_variable = persian_renaissance_historical_sites
		change_variable = {
			name = persian_renaissance_var
			add = 1
		}
	}
}

persian_renaissance_literature = {
	name = "persian_renaissance_literature_button"
	desc = "persian_renaissance_literature_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			has_variable = persian_renaissance_literature
		}
		has_technology_researched = dialectics
		trigger_if = {
			limit = {
				has_global_variable = tsr_uhre
			}
			literacy_rate >= 0.40
		}
		trigger_else = {
			literacy_rate >= 0.65
		}
		any_scope_building = {
			count >= 3
			is_building_type = building_arts_academy
			occupancy >= 0.9
			level >= 5
		}
	}

	effect = {
		trigger_event = { id = persian_renaissance.1 }
		set_variable = persian_renaissance_literature
		change_variable = {
			name = persian_renaissance_var
			add = 1
		}
	}
}

persian_renaissance_architecture = {
	name = "persian_renaissance_architecture_button"
	desc = "persian_renaissance_architecture_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			has_variable = persian_renaissance_architecture
		}
		NOT = {
			any_scope_building = {
				is_building_type = building_construction_sector
				building_has_goods_shortage = yes
				has_active_production_method = pm_wooden_buildings
			}
		}
		capital = {
			any_scope_building = {
				is_building_type = building_urban_center
				level >= 15
			}
		}
	}

	effect = {
		trigger_event = { id = persian_renaissance.8 }
		set_variable = persian_renaissance_architecture
		change_variable = {
			name = persian_renaissance_var
			add = 1
		}
	}
}

persian_renaissance_textile_arts = {
	name = "persian_renaissance_textile_arts_button"
	desc = "persian_renaissance_textile_arts_button_desc"

	visible = { always = yes }

	possible = {
		NOT = {
			has_variable = persian_renaissance_textile_arts
		}
		any_scope_building = {
			count >= 3
			is_building_type = building_textile_mill
			has_active_production_method = pm_craftsman_sewing
			building_has_goods_shortage = no
			occupancy >= 0.9
			level >= 25
		}
		any_market = {
			count >= 10
			NOT = { owner = root }
			any_trade_route = {
				exporter.owner = root
				OR = {
					goods = g:luxury_clothes
					goods = g:clothes
				}
				is_trade_route_productive = yes
			}
		}
	}

	effect = {
		trigger_event = { id = persian_renaissance.10 }
		set_variable = persian_renaissance_textile_arts
		change_variable = {
			name = persian_renaissance_var
			add = 1
		}
	}
}

#persian_renaissance_romantic_nationalism = {
#	name = "persian_renaissance_romantic_nationalism_button"
#	desc = "persian_renaissance_romantic_nationalism_button_desc"
#
#	visible = { always = yes }
#
#	possible = {
#		NOT = {
#			has_variable = persian_renaissance_romantic_nationalism
#		}
#		has_technology_researched = nationalism
#		custom_tooltip = {
#			text = persian_renaissance_historical_sites_tt
#			has_variable = persian_renaissance_historical_sites
#		}
#	}
#
#	effect = {
#		trigger_event = { id = persian_renaissance.7 }
#		set_variable = persian_renaissance_romantic_nationalism
#		change_variable = {
#			name = persian_renaissance_var
#			add = 1
#		}
#	}
#}

# Edict of Yazd
edict_of_yazd_button = {
	name = "edict_of_yazd_button"
	desc = "edict_of_yazd_button_desc"

	visible = { always = yes }

	possible = {
		has_law = law_type:law_state_religion
		c:PER ?= {
			OR = {
				AND = {
					any_scope_character = {
						is_ruler = yes
						is_heir = yes
						OR = {
							has_ideology = ideology:ideology_reformer
							has_ideology = ideology:ideology_persian_constitutionalist
						}
						age >= 20
					}
				}
				ig:ig_devout = {
					is_in_government = no
					is_being_suppressed = yes
					ig_clout < 0.2
					leader = {
						NOT = { has_ideology = ideology:ideology_persian_constitutionalist }
					}
				}
			}
			OR = {
				is_enacting_law = law_type:law_freedom_of_conscience
				is_enacting_law = law_type:law_shared_roots
			}
			custom_tooltip = {
				text = edict_of_yazd_button_tt
				trigger_if = {
					limit = {
						OR = {
							is_enacting_law = law_type:law_freedom_of_conscience
							is_enacting_law = law_type:law_shared_roots
						}
					}
					enactment_phase >= 1
				}
				trigger_else = {
					always = no
				}
			}
		}
	}

	ai_chance = {
		base = 0
		modifier = {
			trigger = { 
				ig:ig_devout = {
					is_in_government = no
					leader = {
						NOT = { has_ideology = ideology:ideology_persian_constitutionalist }
					}
				}
			}
			add = 2
		}
		modifier = {
			trigger = { 
				ig:ig_devout = {
					is_in_government = no
					is_being_suppressed = yes
					leader = {
						NOT = { has_ideology = ideology:ideology_persian_constitutionalist }
					}
				}
			}
			add = 4
		}
		modifier = {
			trigger = { 
				any_interest_group = {
					is_in_government = yes
					OR = {
						leader = {
							OR = {
								has_ideology = ideology:ideology_reformer
								has_ideology = ideology:ideology_persian_constitutionalist
							}
						}
						law_stance = {
							law = law_type:law_state_religion
							value = strongly_disapprove
						}
					}
				}
			}
			add = 7
		}
		modifier = {
			trigger = { 
				OR = {
					is_at_war = yes
					any_revolution_ongoing = yes
				}
			}
			add = -1000
		}
	}

	effect = {
		custom_tooltip = edict_of_yazd_button_tt_2
		if = {
			limit = {
				is_enacting_law = law_type:law_freedom_of_conscience
			}
			activate_law = law_type:law_freedom_of_conscience
			ig:ig_devout = {
				add_modifier = {
					name = outraged_over_yazd_edict_1_modifier
					months = normal_modifier_time
				}
			}
		}
		else_if = {
			limit = {
				is_enacting_law = law_type:law_shared_roots
			}
			activate_law = law_type:law_shared_roots
			ig:ig_devout = {
				add_modifier = {
					name = outraged_over_yazd_edict_2_modifier
					months = normal_modifier_time
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { NOT = { has_variable = zandism_secularization } }
				set_variable = zandism_secularization
			}
		}
	}
}

# Suppress Slave Trade Button
je_slave_trade_suppression_button = {
	name = "je_slave_trade_suppression_button"
	desc = "je_slave_trade_suppression_button_desc"

	visible = {
		has_law = law_type:law_slave_trade 
		NOT = { has_variable = var_slave_trade_suppression_var }
	}

	possible = {
		ig:ig_landowners = {
			is_in_government = no
		}
		custom_tooltip = {
			text = slave_trade_button_cooldown_tt
			NOT = {
				has_variable = slave_trade_button_cooldown_var
			}
		}
	}

	effect = {
		custom_tooltip = je_slave_trade_suppression_button_tt
		set_variable = var_slave_trade_suppression_var
		set_variable = {
			name = slave_trade_button_cooldown_var
			months = short_modifier_time
		}
		every_interest_group = {
			limit = {
                law_stance = {
                    law = law_type:law_slave_trade
                    value > neutral
                }
			}
			add_modifier = {
				name = restricted_slave_trade_ig_modifier
			}
		}
		remove_modifier = unrestricted_slave_trade_modifier
		add_modifier = {
			name = restricted_slave_trade_modifier
		}
	}
}

# Stop Suppressing Slave Trade Button
je_slave_trade_end_suppression_button = {
	name = "je_slave_trade_end_suppression_button"
	desc = "je_slave_trade_end_suppression_button_desc"

	visible = {
		has_law = law_type:law_slave_trade 
		has_variable = var_slave_trade_suppression_var
	}

	possible = {
		custom_tooltip = {
			text = slave_trade_button_cooldown_tt
			NOT = {
				has_variable = slave_trade_button_cooldown_var
			}
		}
	}

	effect = {
		custom_tooltip = je_slave_trade_end_suppression_button_tt
		remove_variable = var_slave_trade_suppression_var
		remove_modifier = restricted_slave_trade_modifier
		set_variable = {
			name = slave_trade_button_cooldown_var
			months = short_modifier_time
		}
		every_interest_group = {
			limit = {
				has_modifier = restricted_slave_trade_ig_modifier
			}
			remove_modifier = restricted_slave_trade_ig_modifier
		}
		add_modifier = {
			name = unrestricted_slave_trade_modifier
		}
	}
}
