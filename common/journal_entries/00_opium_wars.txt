je_opium_obsession = {
	icon = "gfx/interface/icons/event_icons/event_scales.dds"

	group = je_group_internal_affairs

	on_monthly_pulse = {
		random_events = {
			100 = 0
			10 = opium_wars.6
			5 = opium_wars.7
			5 = opium_wars.8
			5 = crime_events.2
		}
		effect = {
			if = {
				limit = {
					is_banning_goods = opium
				}
				change_variable = {
					name = opium_wars_completion_tracker
					add = 1
				}
			}
		}
	}

	complete = {
		scope:journal_entry = { is_goal_complete = yes }
		custom_tooltip = {
			text = opium_ban_tt
			is_banning_goods = opium
		}
		is_at_war = no
		NOT = { has_law = law_type:law_no_substances_regulation }
	}

	on_complete = {
		if = {
			limit = { has_variable = opium_wars_aggressor }
			remove_variable = opium_wars_aggressor
		}
		trigger_event = {
			id = opium_wars.3
		}
	}
	
	timeout = 5475

	current_value = {
		value = root.var:opium_wars_completion_tracker
	}

	goal_add_value = {
		add = 120 #10 years
	}

	progressbar = yes

	weight = 10000
	should_be_pinned_by_default = yes
}

je_opium_wars = {
	icon = "gfx/interface/icons/event_icons/event_military.dds"

	group = je_group_foreign_affairs
	
	complete = {
		OR = {
			NOT = { exists = c:PER }
			AND = {
				exists = c:PER
				c:PER = {
					any_scope_state = {
						state_region = {
							is_homeland = cu:persian
						}
						NOT = { owner = prev }
					}
					is_banning_goods = opium
				}
			}
		}
	}

	on_complete = {
		if = {
			limit = {
				any_scope_state = {
					state_region = {
						is_homeland = cu:persian
					}
				}
			}
			trigger_event = {
				id = opium_wars.4
				days = 5
			}
		}
		hidden_effect = {
			c:PER = {
				trigger_event = {
					id = opium_wars.4
					days = 5
				}
			}
		}
	}

	fail = {
		custom_tooltip = {
			text = opium_wars_fail_tt
			AND = {
				exists = c:PER
				has_diplomatic_pact = {
					who = c:PER
					type = war_reparations
				}
			}
		}
	}

	on_fail = {
		custom_tooltip = {
			text = opium_wars_fail_invalid_tt
			remove_variable = opium_wars_aggressor
			random_country = {
				limit = {
					has_variable = opium_wars_exporter
				}
				remove_variable = opium_wars_exporter
			}
		}
	}

	on_timeout = {
		custom_tooltip = {
			text = opium_wars_fail_invalid_tt
			remove_variable = opium_wars_aggressor
			random_country = {
				limit = {
					has_variable = opium_wars_exporter
				}
				remove_variable = opium_wars_exporter
			}
		}
	}

	weight = 10000
	should_be_pinned_by_default = yes

	timeout = 3650
}
