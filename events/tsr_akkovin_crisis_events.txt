namespace = akkovin_crisis

# Start event
akkovin_crisis.1 = {
	type = country_event
	placement = root
	title = akkovin_crisis.1.t
	desc = akkovin_crisis.1.d
	flavor = akkovin_crisis.1.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	immediate = {
		set_variable = {
			name = akc_reform_var
			value = 0
		}
		add_journal_entry = {
			type = je_akkovin_crisis
		}
	}

	option = {
		name = akkovin_crisis.1.a
		add_journal_entry = {
			type = je_akkovin_reform_economy
		}
		add_journal_entry = {
			type = je_akkovin_reform_education
		}
		add_journal_entry = {
			type = je_akkovin_reform_army
		}
		add_journal_entry = {
			type = je_akkovin_reform_navy
		}
		add_journal_entry = {
			type = je_akkovin_reform_bureaucracy
		}
		add_journal_entry = {
			type = je_akkovin_reform_sovereignty
		}
		add_journal_entry = {
			type = je_akkovin_reform_kurdish
		}
		add_journal_entry = {
			type = je_akkovin_reform_arabia
		}
		add_journal_entry = {
			type = je_akkovin_reform_minorities
		}
		add_journal_entry = {
			type = je_akkovin_reform_nationalism
		}
	}
}

# Fail event
akkovin_crisis.2 = { # Collapse of the Akkovin Confederation
	type = country_event
	placement = root
	title = akkovin_crisis.2.t
	desc = akkovin_crisis.2.d
	flavor = akkovin_crisis.2.f
	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	trigger = {
	}

	immediate = {
		set_variable = akkovin_fail
	}
	
	option = {
		name = akkovin_crisis.2.a
		if = {
			limit = {
				any_subject_or_below = {
					OR = {
						country_is_in_europe = yes
						country_is_in_middle_east = yes
					}
				}
			}
			every_subject_or_below = {
				limit = {
					OR = {
						country_is_in_europe = yes
						country_is_in_middle_east = yes
					}
				}
				make_independent = yes
			}
		}
		set_country_type = unrecognized
		#Beginning of Akkovin partition for their neighbors
	}

#MOVE THIS ALL TO ARAB REVOLUTION JE
#	option = {
#		name = akkovin_crisis.2.a # Reconquer our subjects
#		default_option = yes
#		ai_value = 100
#		hidden_effect = {
#			c:SYR = {
#				create_diplomatic_pact = {
#					country = c:JAB
#					type = defensive_pact
#				}
#				create_diplomatic_pact = {
#					country = c:NEJ
#					type = defensive_pact
#				}
#				create_diplomatic_pact = {
#					country = c:HDJ
#					type = defensive_pact
#				}
#				change_relations = {
#					country = c:JAB
#					value = 100
#				}
#				change_relations = {
#					country = c:NEJ
#					value = 100
#				}
#				change_relations = {
#					country = c:HDJ
#					value = 100
#				}
#				set_tariffs_import_priority = g:small_arms
#				set_tariffs_import_priority = g:artillery
#			}
#			c:JAB = {
#				create_diplomatic_pact = {
#					country = c:NEJ
#					type = defensive_pact
#				}
#				create_diplomatic_pact = {
#					country = c:HDJ
#					type = defensive_pact
#				}
#				change_relations = {
#					country = c:NEJ
#					value = 100
#				}
#				change_relations = {
#					country = c:HDJ
#					value = 100
#				}
#			}
#			c:NEJ = {
#				create_diplomatic_pact = {
#					country = c:HDJ
#					type = defensive_pact
#				}
#				change_relations = {
#					country = c:HDJ
#					value = 100
#				}
#			}
#			c:HDJ = {
#				set_tariffs_import_priority = g:small_arms
#				set_tariffs_import_priority = g:artillery
#			}
#		}
#		create_diplomatic_play = {
#			name = arab_independence_war
#			target_country = c:SYR
#			war = yes
#			type = dp_make_puppet
#			
#			add_initiator_backers = {
#				c:PER #In the future only if they choose to support you in the Arab Wars JE
#				#c:SCA (wait until the Arab Wars JE)
#			}
#			
#			add_target_backers = {
#				c:TUR  #In the future only if they choose to support you in the Arab Wars JE
#				#c:FRA (wait until the Arab Wars JE)
#			}
#			
#			add_war_goal = {
#				holder = c:AKN
#				type = make_puppet
#				target_country = c:HDJ
#			}
#			add_war_goal = {
#				holder = c:AKN
#				type = make_puppet
#				target_country = c:NEJ
#			}
#			add_war_goal = {
#				holder = c:AKN
#				type = make_puppet
#				target_country = c:JAB
#			}
#			add_war_goal = {
#				holder = c:SYR
#				type = return_state
#				target_state = s:STATE_ALEPPO.region_state:AKN
#			}
#		}
#	}
#	option = {
#		name = akkovin_crisis.2.b # Back down
#		ai_value = 0
#		add_modifier = {
#			name = akn_back_down_arab_wars
#			months = normal_modifier_time
#		}
#	}
}

# Crisis averted
akkovin_crisis.3 = {
	type = country_event
	placement = root
	title = akkovin_crisis.3.t
	desc = akkovin_crisis.3.d
	flavor = akkovin_crisis.3.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	immediate = {
		set_variable = akc_reforms_complete
		remove_modifier = akkovin_crisis
		remove_modifier = outmoded_bureaucracy
		remove_modifier = tribal_structures
		remove_modifier = cizye_tax
		add_modifier = {
			name = akn_crisis_averted_country
			months = normal_modifier_time
		}
		every_interest_group = {
			limit = {
				NOT = { is_interest_group_type = ig_trade_unions }
			}
			add_modifier = {
				name = akn_crisis_averted_ig
				months = normal_modifier_time
			}
		}
		add_loyalists = {
			culture = cu:akturk
			value = 0.25
		}
		add_loyalists = {
			culture = cu:kurdish
			value = 0.25
		}
	}

	option = {
		name = akkovin_crisis.3.a
		default_option = yes
		trigger = {
			has_variable = completed_sick_man_army_je
		}
		add_modifier = {
			name = akkovin_army_reform
			months = normal_modifier_time
		}
	}
	option = {
		name = akkovin_crisis.3.b
		trigger = {
			AND = {
				has_variable = completed_akkovin_reform_sovereignty_je
				has_variable = completed_akkovin_reform_arabia_je
			}
			NAND = {
				owns_entire_state_region = STATE_HARPUT
				owns_entire_state_region = STATE_SIVAS
				owns_entire_state_region = STATE_CYPRUS
				owns_entire_state_region = STATE_SHAHRIZOR
				owns_entire_state_region = STATE_KARS
				owns_entire_state_region = STATE_ARMENIA
			}
		}
		s:STATE_HARPUT = {
			add_claim = ROOT
		}
		s:STATE_SIVAS = {
			add_claim = ROOT
		}
		s:STATE_CYPRUS = {
			add_claim = ROOT
		}
		s:STATE_SHAHRIZOR = {
			add_claim = ROOT
		}
		s:STATE_KARS = {
			add_claim = ROOT
		}
		s:STATE_ARMENIA = {
			add_claim = ROOT
		}
	}
	option = {
		name = akkovin_crisis.3.c
		trigger = {
			has_variable = completed_akkovin_reform_economy_je
		}
		add_modifier = {
			name = akkovin_urbanization
			months = normal_modifier_time
		}
	}
	option = {
		name = akkovin_crisis.3.d
		trigger = {
			has_variable = completed_akkovin_reform_education_je
		}
		add_modifier = {
			name = akkovin_education
			months = normal_modifier_time
		}
	}
	option = {
		name = akkovin_crisis.3.e
		trigger = {
			has_variable = completed_akkovin_reform_bureaucracy_je
		}
		add_modifier = {
			name = akkovin_bureaucracy
			months = normal_modifier_time
		}
	}
}

# Fate of the Gunpowder Alliance (For Safavids)
akkovin_crisis.4 = {
	type = country_event
	placement = root
	title = akkovin_crisis.4.t
	desc = akkovin_crisis.4.d
	flavor = akkovin_crisis.4.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
		AND = { exists = c:PER c:PER = this }
		year > 1838
		has_diplomatic_pact = {
			who = c:AKN
			type = trade_agreement
		}
		NOT = { has_variable = pre_treaty }
	}

	immediate = {
		set_variable = pre_treaty
	}

	option = {
		name = akkovin_crisis.4.a
	}
}

# An Agreement with the Safavid Empire?
akkovin_crisis.5 = {
	type = country_event
	placement = root
	title = akkovin_crisis.5.t
	desc = akkovin_crisis.5.d
	flavor = akkovin_crisis.5.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	immediate = {
		
	}

	option = {
		name = akkovin_crisis.5.a
	}
}

# The Treaty of Baglar
akkovin_crisis.6 = {
	type = country_event
	placement = root
	title = akkovin_crisis.6.t
	desc = akkovin_crisis.6.d
	flavor = akkovin_crisis.6.f

	duration = 3

	event_image = {
		video = "gfx/event_pictures/unspecific_factory_closed.bk2"
	}

	on_created_soundeffect = "event:/SFX/UI/Alerts/event_appear"
	on_opened_soundeffect = "event:/SFX/Events/unspecific/factory_closed"

	icon = "gfx/interface/icons/event_icons/event_skull.dds"

	trigger = {
	}

	option = {
		name = akkovin_crisis.6.a
		add_modifier = {
			name = treaty_of_baglar
			months = -1
		}
		#Tooltip = The treaty marks the beginning of Persian enroachment into Akkovin politics
	}
}